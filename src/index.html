<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Brandon Mosher</title>
    <link rel="preconnect" href="https://raw.githubusercontent.com">
    <link rel="preconnect" href="https://api.github.com">
</head>

<body>
    <on-scroll-container class="scroll-snap-container">
        <on-scroll query-selector-apply="nav-bar" scroll-up-start-remove-class="nav-bar-hide"
            scroll-up-stop-add-class="nav-bar-hide" scroll-down-start-add-class="nav-bar-hide"
            scroll-up-max-add-class="nav-bar-transparent" scroll-down-start-remove-class="nav-bar-transparent">
        </on-scroll>
        <nav-bar class="header">
            <nav-entry href="#home">Home</nav-entry>
            <nav-entry href="#resume">Resume</nav-entry>
            <nav-entry href="#skills">Skills</nav-entry>
            <nav-entry href="#projects">Projects</nav-entry>
            <nav-entry href="#experience">Experience</nav-entry>
            <nav-entry href="#contact">Contact</nav-entry>
        </nav-bar>
        <parallax-group scroll-parent="body">
            <parallax-layer id="parallax-layer-foreground">
                <nav-section id="home" class="center-children scroll-snap-center">
                    <div id="intro-container">
                        <h1>I<span>'</span>M<br>Brandon<br>Mosher<span>.</span>
                        </h1>
                        <h2>Software Engineer</h2>
                    </div>
                </nav-section>

                <padding-section class="height-50"></padding-section>

                <nav-section id="resume" class="horizontal-center-children scroll-snap-center">
                    <nav-section-header>
                        <h3><span>01</span> Resume</h3>
                    </nav-section-header>
                    <on-intersection-add-class id="resume-container" class="content-container"
                        enter-any-add-class="transition-fade-in">
                        <div id="resume-summary-container"></div>
                        <div id="resume-download-container">
                            <a id="resume-download-button"
                                href="https://raw.githubusercontent.com/brandonmosher/resume/main/build/resume/resume.pdf"
                                target="_blank" rel="noopener noreferrer" data-type="document">
                                <span>Download Resume</span>
                            </a>
                        </div>
                    </on-intersection-add-class>
                </nav-section>

                <padding-section class="height-50"></padding-section>

                <nav-section id="skills" class="horizontal-center-children scroll-snap-center">
                    <nav-section-header>
                        <h3><span>02</span> Skills</h3>
                    </nav-section-header>
                    <on-intersection-add-class id="progress-bar-container" class="content-container"
                        query-selector="progress-bar-borderless" enter-any-add-class="ready">
                    </on-intersection-add-class>
                </nav-section>

                <padding-section class="height-50"></padding-section>

                <nav-section id="projects" class="horizontal-center-children scroll-snap-center">
                    <nav-section-header>
                        <h3><span>03</span> Projects</h3>
                    </nav-section-header>
                    <projects id="projects-container" class="content-container">
                        <git-user user-login="brandonmosher"></git-user>
                    </projects>
                </nav-section>

                <padding-section class="height-50"></padding-section>

                <nav-section id="experience" threshold="0.3"
                    class="height-250 horizontal-center-children scroll-snap-start">
                    <nav-section-header>
                        <h3><span>04</span> Experience</h3>
                    </nav-section-header>
                    <vertical-timeline></vertical-timeline>
                </nav-section>

                <padding-section class="height-75"></padding-section>

                <nav-section id="contact" class="horizontal-center-children scroll-snap-start">
                    <nav-section-header>
                        <h3><span>05</span> Contact</h3>
                    </nav-section-header>
                    <form id="contact-form" name="contact-form" class="content-container"
                        action="https://lmzel5xwlf.execute-api.us-east-1.amazonaws.com/live">
                        <form-control type="text" id="name" name="name" title="Hi, what's your name?" required="*">
                            Name</form-control>

                        <form-control type="email" id="email" name="email" title="john.smith@example.com" required="*">
                            Email
                        </form-control>

                        <form-control type="tel" id="phone" name="phone" title="(111) 111-1111"
                            pattern="\([0-9]{3}\) [0-9]{3}-[0-9]{4}" template="(___) ___-____" template-placeholder="_"
                            allowed="0123456789">Phone</form-control>

                        <form-control type="textarea" id="message" name="message" title="Say hello!" required="*">
                            Message
                        </form-control>

                        <form-control type="submit" id="submit" value="">Submit</form-control>
                    </form>
                    <script>
                        const form = document.querySelector('form');
                        form.addEventListener('submit', (e) => {
                            e.preventDefault();
                            form.querySelectorAll('form-control:not([type=submit])').forEach((node, i, arr) => {
                                node.style.transitionDuration = `${i / (2 * arr.length)}s`;
                                node.style.transitionDelay = `${(arr.length - i) / (3 * arr.length)}s`;
                                node.classList.add('squashed-form-control');
                            });
                            document.querySelector('form-control[type=submit]').innerText = 'Thank You!';
                        });

                        const makeId = name => name.toLowerCase().replace(/(\+|\(|\))/g, '').replace(/,| /g, '-').replace(/-{2,}/g, '-')

                        const makeSkillId = (name) => `progress-bar-${makeId(name)}`;

                        const makeSkillHTML = ({ name, proficiencyPercentage } = {}) =>
                            `<progress-bar-borderless id="${makeSkillId(name)}">${name}</progress-bar-borderless>`

                        const makeSkillCSS = ({ i, name, proficiencyPercentage } = {}) => `#${makeSkillId(name)}.ready {--bar-completed-percentage: ${parseInt(proficiencyPercentage)}; transition-delay: ${0.2 * i}s}`;

                        const makeProjectHTML = ({ url, name, cvparagraph, gitHubRepoName } = {}) => {
                            if (gitHubRepoName) {
                                const [repoOwner, repoName] = gitHubRepoName.split('/');
                                return `<git-repo repo-owner="${repoOwner}"" repo-name="${repoName}"></git-repo>`;
                            }
                            return `<project id="project-${makeId(name)}"><a href="${url}">${name}</a><div>${cvparagraph}</div></project>`
                        }

                        const makeExperienceHTML = ({ startDate, endDate, organization, jobTitle, cvitems } = {}) =>
                            `<on-intersection-add-class threshold="0.50" enter-bottom-add-class="bounce">
                                <vertical-timeline-entry>
                                    <h4>${startDate} - ${endDate}</h4>
                                    <div-border>
                                        <div>
                                            <h5>${organization}</h5>
                                            <h6>${jobTitle}</h6>
                                            <p>${cvitems}</p>
                                        </div>
                                    </div-border>
                                </vertical-timeline-entry>
                            </on-intersection-add-class>`;
                        
                        fetch('https://raw.githubusercontent.com/brandonmosher/resume/main/build/cv/cv.json')
                            .then(response => response.json())
                            .then(json => {
                                const skillsInnerHTML = json.document.cv.skills.cventries.reduce((innerHTML, cvskill) => {
                                    return innerHTML + makeSkillHTML(cvskill);
                                }, '');
                                
                                const maxProficiencyPercentage = json.document.cv.skills.cventries.reduce(
                                    (maxProficiencyPercentage, cvskill) => Math.max(maxProficiencyPercentage, parseInt(cvskill.proficiencyPercentage)), 0);
                                const maxBarWidth = 100 - 20 - 5;
                                const paddingLeft = maxBarWidth * (1 - (maxProficiencyPercentage / 100)) / 2;

                                let skillsCSS = `progress-bar-borderless {padding-left: ${paddingLeft}%;}`

                                skillsCSS += json.document.cv.skills.cventries.reduce((skillsCSS, cvskill, i) => {
                                    return skillsCSS + makeSkillCSS({i, ...cvskill});
                                }, '');
                                
                                const projectsInnerHTML = json.document.cv.projects.cventries.reduce((projectsInnerHTML, cvproject) => {
                                    return projectsInnerHTML + makeProjectHTML(cvproject);
                                }, '');
                                
                                const experienceInnerHTML = json.document.cv.experience.cventries.reduce((experienceInnerHTML, cventry) => {
                                    cventry.cvitems = cventry.cvitems.join(" ");
                                    return experienceInnerHTML + makeExperienceHTML(cventry);
                                }, '');

                                const style = document.createElement('style');
                                style.innerHTML += skillsCSS;
                                style.innerHTML += `vertical-timeline on-intersection-add-class {height: ${100 / json.document.cv.experience.cventries.length}%;}`;
                                document.head.appendChild(style);

                                const p = document.createElement('p');
                                p.innerText = json.document.cv.summary.cvparagraph;
                                document.querySelector('#resume-summary-container').appendChild(p);
                                document.querySelector('#progress-bar-container').innerHTML += skillsInnerHTML;
                                document.querySelector('projects').innerHTML += projectsInnerHTML;
                                document.querySelector('vertical-timeline').innerHTML = experienceInnerHTML;
                            });
                    </script>
                    <div id="footer">
                        <a href="https://icons8.com">Icons from Icons8</a>
                        <a href="https://fonts.google.com/specimen/Roboto+Mono">Fonts from Google</a>
                    </div>
                </nav-section>

            </parallax-layer>

            <parallax-layer id="parallax-layer-background">
                <tinted-background id="background1"></tinted-background>
                <tinted-background id="background2"></tinted-background>
                <tinted-background id="background3"></tinted-background>
                <tinted-background id="background4"></tinted-background>
                <tinted-background id="background5"></tinted-background>
            </parallax-layer>
        </parallax-group>
    </on-scroll-container>
</body>

</html>